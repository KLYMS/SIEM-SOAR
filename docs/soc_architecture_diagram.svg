<svg viewBox="0 0 1400 900" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="containerGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0db7ed;stop-opacity:0.1" />
      <stop offset="100%" style="stop-color:#0db7ed;stop-opacity:0.25" />
    </linearGradient>
    <linearGradient id="wazuhGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1e3a8a" />
      <stop offset="100%" style="stop-color:#3b82f6" />
    </linearGradient>
    <linearGradient id="grafanaGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f97316" />
      <stop offset="100%" style="stop-color:#fb923c" />
    </linearGradient>
    <linearGradient id="graylogGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#dc2626" />
      <stop offset="100%" style="stop-color:#ef4444" />
    </linearGradient>
    <linearGradient id="hiveGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#eab308" />
      <stop offset="100%" style="stop-color:#facc15" />
    </linearGradient>
    <linearGradient id="shuffleGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#7c3aed" />
      <stop offset="100%" style="stop-color:#a855f7" />
    </linearGradient>
    <linearGradient id="veloGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#059669" />
      <stop offset="100%" style="stop-color:#10b981" />
    </linearGradient>
    <linearGradient id="agentGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#374151" />
      <stop offset="100%" style="stop-color:#6b7280" />
    </linearGradient>
    <linearGradient id="groupGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f8fafc;stop-opacity:0.9" />
      <stop offset="100%" style="stop-color:#e2e8f0;stop-opacity:0.9" />
    </linearGradient>
    <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
      <feMerge> 
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="3" dy="3" stdDeviation="4" flood-opacity="0.3"/>
    </filter>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#4f46e5"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#dc2626"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#059669"/>
    </marker>
    <marker id="arrowPurple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#7c3aed"/>
    </marker>
    <marker id="arrowOrange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#f97316"/>
    </marker>
  </defs>
  
  <!-- Docker Container Environment -->
  <rect x="60" y="60" width="1280" height="780" rx="20" fill="url(#containerGrad)" stroke="#0db7ed" stroke-width="4" stroke-dasharray="15,8" filter="url(#shadow)"/>
  <text x="700" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="28" font-weight="bold" fill="#0db7ed">🐳 SIEM-SOAR Lab - Docker Environment</text>
  
  <!-- External Data Sources Group -->
  <rect x="100" y="140" width="250" height="140" rx="12" fill="url(#groupGrad)" stroke="#9ca3af" stroke-width="2" filter="url(#shadow)"/>
  <text x="225" y="170" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#374151">🌐 Data Sources</text>
  
  <!-- Linux Agent -->
  <rect x="120" y="190" width="90" height="70" rx="8" fill="url(#agentGrad)" filter="url(#shadow)"/>
  <text x="165" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">🐧 Linux</text>
  <text x="165" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">Agent</text>
  <text x="165" y="240" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#d1d5db">Endpoint</text>
  <text x="165" y="250" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#d1d5db">Monitoring</text>
  
  <!-- Customer Assets -->
  <rect x="240" y="190" width="90" height="70" rx="8" fill="#6366f1" filter="url(#shadow)"/>
  <text x="285" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">🏢 Assets</text>
  <text x="285" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#e0e7ff">Servers</text>
  <text x="285" y="240" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#e0e7ff">Workstations</text>
  <text x="285" y="250" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#e0e7ff">Network</text>
  
  <!-- SIEM & Log Management Group -->
  <rect x="400" y="140" width="320" height="140" rx="12" fill="url(#groupGrad)" stroke="#9ca3af" stroke-width="2" filter="url(#shadow)"/>
  <text x="560" y="170" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#374151" text-anchor="middle">🛡️ SIEM & Log Management</text>
  
  <!-- Wazuh -->
  <rect x="420" y="190" width="130" height="80" rx="10" fill="url(#wazuhGrad)" filter="url(#glow)"/>
  <text x="485" y="215" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white">🛡️ Wazuh</text>
  <text x="485" y="230" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#dbeafe">Security Platform</text>
  <text x="485" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#bfdbfe">Threat Detection</text>
  <text x="485" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#bfdbfe">Compliance</text>
  
  <!-- Graylog -->
  <rect x="570" y="190" width="130" height="80" rx="10" fill="url(#graylogGrad)" filter="url(#glow)"/>
  <text x="635" y="215" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white">📊 Graylog</text>
  <text x="635" y="230" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#fecaca">Log Management</text>
  <text x="635" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#fca5a5">Search & Analysis</text>
  <text x="635" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#fca5a5">Alerting</text>
  
  <!-- Visualization & Storage Group -->
  <rect x="760" y="140" width="500" height="140" rx="12" fill="url(#groupGrad)" stroke="#9ca3af" stroke-width="2" filter="url(#shadow)"/>
  <text x="1010" y="170" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#374151" text-anchor="middle">📈 Visualization & Storage</text>
  
  <!-- Grafana -->
  <rect x="780" y="190" width="130" height="80" rx="10" fill="url(#grafanaGrad)" filter="url(#glow)"/>
  <text x="845" y="215" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white">📈 Grafana</text>
  <text x="845" y="230" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#fed7aa">Dashboards</text>
  <text x="845" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#fdba74">Visualization</text>
  <text x="845" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#fdba74">Monitoring</text>
  
  <!-- Storage Components -->
  <rect x="940" y="190" width="70" height="35" rx="6" fill="#4b5563" filter="url(#shadow)"/>
  <text x="975" y="208" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="white">OpenSearch</text>
  <text x="975" y="218" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#d1d5db">Indexer</text>
  
  <rect x="1020" y="190" width="70" height="35" rx="6" fill="#6b7280" filter="url(#shadow)"/>
  <text x="1055" y="208" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="white">Cassandra</text>
  <text x="1055" y="218" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#d1d5db">Database</text>
  
  <rect x="1100" y="190" width="70" height="35" rx="6" fill="#6b7280" filter="url(#shadow)"/>
  <text x="1135" y="208" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="white">Elasticsearch</text>
  <text x="1135" y="218" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#d1d5db">Search</text>
  
  <rect x="1180" y="190" width="70" height="35" rx="6" fill="#6b7280" filter="url(#shadow)"/>
  <text x="1215" y="208" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="white">MongoDB</text>
  <text x="1215" y="218" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#d1d5db">NoSQL</text>
  
  <!-- Incident Response Group -->
  <rect x="400" y="320" width="320" height="140" rx="12" fill="url(#groupGrad)" stroke="#9ca3af" stroke-width="2" filter="url(#shadow)"/>
  <text x="560" y="350" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#374151">🎯 Incident Response</text>
  
  <!-- TheHive + Cortex -->
  <rect x="420" y="370" width="140" height="80" rx="10" fill="url(#hiveGrad)" filter="url(#glow)"/>
  <text x="490" y="395" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#92400e">🐝 TheHive</text>
  <text x="490" y="410" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#92400e">+ Cortex</text>
  <text x="490" y="425" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#a16207">Case Management</text>
  <text x="490" y="435" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#a16207">Threat Intel</text>
  
  <!-- Velociraptor -->
  <rect x="580" y="370" width="120" height="80" rx="10" fill="url(#veloGrad)" filter="url(#glow)"/>
  <text x="640" y="395" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white">🦖 Velociraptor</text>
  <text x="640" y="410" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#bbf7d0">Digital Forensics</text>
  <text x="640" y="425" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#86efac">Endpoint Analysis</text>
  <text x="640" y="435" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#86efac">Artifact Collection</text>
  
  <!-- SOAR Automation Group -->
  <rect x="400" y="500" width="320" height="120" rx="12" fill="url(#groupGrad)" stroke="#9ca3af" stroke-width="2" filter="url(#shadow)"/>
  <text x="560" y="530" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#374151">🔀 Security Orchestration</text>
  
  <!-- Shuffle SOAR -->
  <rect x="440" y="550" width="240" height="60" rx="12" fill="url(#shuffleGrad)" filter="url(#glow)"/>
  <text x="560" y="575" text-anchor="middle" font-family="Arial, sans-serif" font-size="15" font-weight="bold" fill="white">🔀 Shuffle SOAR</text>
  <text x="560" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#e9d5ff">Automated Workflows & Playbooks</text>
  <text x="560" y="600" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ddd6fe">Security Orchestration Hub</text>
  
  <!-- Management Infrastructure -->
  <rect x="100" y="680" width="1140" height="140" rx="10" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" filter="url(#shadow)"/>
  <text x="670" y="710" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#1e293b">⚙️ Platform Infrastructure & Management</text>
  
  <text x="130" y="740" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#475569">🔧 Docker Services:</text>
  <text x="130" y="760" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Compose orchestration</text>
  <text x="130" y="775" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Service networking</text>
  <text x="130" y="790" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Volume persistence</text>
  <text x="130" y="805" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Health monitoring</text>
  
  <text x="330" y="740" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#475569">📋 Configuration:</text>
  <text x="330" y="760" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Environment variables</text>
  <text x="330" y="775" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Service discovery</text>
  <text x="330" y="790" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Log aggregation</text>
  <text x="330" y="805" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Alert routing</text>
  
  <text x="530" y="740" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#475569">🚀 Automation:</text>
  <text x="530" y="760" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Deployment scripts</text>
  <text x="530" y="775" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Cleanup utilities</text>
  <text x="530" y="790" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Version management</text>
  <text x="530" y="805" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Documentation</text>
  
  <text x="730" y="740" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#475569">🔐 Security:</text>
  <text x="730" y="760" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• TLS/SSL certificates</text>
  <text x="730" y="775" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Authentication</text>
  <text x="730" y="790" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Access controls</text>
  <text x="730" y="805" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Network policies</text>
  
  <text x="930" y="740" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#475569">📊 Monitoring:</text>
  <text x="930" y="760" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• System metrics</text>
  <text x="930" y="775" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Performance data</text>
  <text x="930" y="790" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Resource usage</text>
  <text x="930" y="805" font-family="Arial, sans-serif" font-size="12" fill="#64748b">• Alert dashboards</text>
  
  <!-- Clean Data Flow Arrows -->
  
  <!-- Sources to SIEM -->
  <path d="M 350 225 L 400 225" stroke="#4f46e5" stroke-width="3" marker-end="url(#arrow)" fill="none"/>
  <text x="375" y="215" font-family="Arial, sans-serif" font-size="10" fill="#4f46e5" text-anchor="middle">Logs</text>
  
  <!-- Wazuh to Grafana -->
  <path d="M 550 220 L 760 220" stroke="#f97316" stroke-width="3" marker-end="url(#arrowOrange)" fill="none"/>
  <text x="655" y="210" font-family="Arial, sans-serif" font-size="10" fill="#f97316" text-anchor="middle">Metrics</text>
  
  <!-- Graylog to Storage -->
  <path d="M 700 220 L 760 220" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)" fill="none"/>
  
  <!-- SIEM to Incident Response -->
  <path d="M 485 280 L 485 320" stroke="#059669" stroke-width="3" marker-end="url(#arrowGreen)" fill="none"/>
  <text x="495" y="300" font-family="Arial, sans-serif" font-size="10" fill="#059669">Alerts</text>
  
  <path d="M 635 280 L 635 320" stroke="#dc2626" stroke-width="3" marker-end="url(#arrowRed)" fill="none"/>
  <text x="645" y="300" font-family="Arial, sans-serif" font-size="10" fill="#dc2626">Events</text>
  
  <!-- TheHive to Velociraptor -->
  <path d="M 560 410 L 580 410" stroke="#eab308" stroke-width="3" marker-end="url(#arrow)" fill="none"/>
  <text x="570" y="400" font-family="Arial, sans-serif" font-size="9" fill="#eab308" text-anchor="middle">Hunt</text>
  
  <!-- All to SOAR (clean curved paths) -->
  <path d="M 485 460 L 485 500" stroke="#7c3aed" stroke-width="4" marker-end="url(#arrowPurple)" fill="none"/>
  <path d="M 635 460 L 635 500" stroke="#7c3aed" stroke-width="4" marker-end="url(#arrowPurple)" fill="none"/>
  
  <!-- SIEM to SOAR -->
  <path d="M 485 280 Q 420 380 460 500" stroke="#7c3aed" stroke-width="3" marker-end="url(#arrowPurple)" fill="none"/>
  <path d="M 635 280 Q 680 380 660 500" stroke="#7c3aed" stroke-width="3" marker-end="url(#arrowPurple)" fill="none"/>
  
  <text x="500" y="480" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#7c3aed">Orchestration</text>
  
</svg>